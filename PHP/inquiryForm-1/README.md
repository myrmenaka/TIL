# 2025.7.12 - お問い合わせフォームの総合演習（メール送信なし）

## 目的

これまで学習した `フォーム入力` ・ `バリデーション` ・ `確認画面` ・ `完了画面` の流れを1つの実践的なアプリケーションとしてまとめ、webアプリの基本的な仕組みを体験する

## 目次

- [入力・確認・完了 の3画面構成](#1)
- [POST値の保持とデータの受け渡し](#2)
- [バリデーション処理の再利用](#3)

## 学習内容

<a id="1"></a>

### 入力・確認・完了 の3画面構成

- 入力フォーム  
    ユーザーがデータを入力
- 確認画面  
    入力内容を確認してもらう
- 完了画面  
    送信が完了したことを伝える

---
<a id="2"></a>

### POST値の保持とデータの受け渡し

- `method="post"` フォーム送信し、`$_POST` で値を受け取る
- `hidden` フィールドを使って確認画面から完了画面へデータを渡す

---
<a id="3"></a>

### バリデーション処理の再利用

`Day22` で作成した一括バリデーション関数を活用して、効率よくエラーチェックを行う

---
---
## セキュリティ面での注意

- `$_POST` の内容を表示する際は、`htmlspecialchars()` を使って必ずエスケープ
- 確認画面 → 完了画面 への遷移時、`hiddenフィールドの改ざん` にも注意が必要  
（信頼性が必要な処理はサーバー側で再バリデーション）

## 練習問題 

名前・メールアドレス・メッセージ の3つの項目を入力するお問い合わせフォームを作成し、確認画面と完了画面を含めた3画面構成にする  

- input.php  
    → 入力フォーム
- confirm.php  
    → 確認画面
- complete.php  
    → 完了画面
- validate.php  
    → バリデーション関数の定義  
    ※Day22で作成した、`validate.php` を使用（項目は適時変更）

## 作業チェックリスト

- 入力・確認・完了 の3画面構成を作成できたか
- バリデーション関数を活用できたか
- `hidden` フィールドでPOST値を次画面に渡せたか

## MEMO

- HTML : `placeholder`  
    [参考: mdn web docs : HTML 属性: placeholder](https://developer.mozilla.org/ja/docs/Web/HTML/Reference/Attributes/placeholder)  

- 今までの、Day 8、9、10、11、12、14、21、22 を参考に練習問題を解く  
    特に、Day 10、11、21、22 は重要

- `<!DOCTYPE html>` は、HTMLを記述する直前、つまり ファイルの最上部に書く  

    - `<!DOCTYPE html>` は「このページはHTML5で書いてるよ」とブラウザに宣言するタグ
    - ページ全体の `表示ルールやレイアウトの動作` に影響するから、一番最初にあるべき
    - PHPファイルでも、HTMLを出力するページでは必ずこの宣言を入れておく

    ```php
    <?php
    // PHPの処理があっても OK！ ただし何も表示しないこと（echo などなし）
    session_start();
    // バリデーションや変数の定義などここに書く
    ?>

    <!DOCTYPE html>
    <html lang="ja">
    <head>
        <meta charset="UTF-8">
        <title>お問い合わせフォーム</title>
    </head>
    <body>
        <!-- HTMLの表示。PHPと混ぜてもOK！ -->
    </body>
    </html>
    ```

    注意点：
    - `session_start();` や `header('Location: ...');` を使うときは、HTMLの出力（空白も含む）の前に処理を書く
    - もし `<!DOCTYPE html>` より前に余分な `スペース` や `改行`、`echo` があると、ヘッダー送信ができなくなってエラーの原因になる  
        ※セッションが正常に動作しなくなるような「余分な改行」というのは、ファイルの先頭（＝1行目の `<?php` よりも前）にある改行やスペースのこと

- まだコードが英語の塊に見える  
    → 文字で頭に入るように（読めるように）したい

---

参考: []()
