# 条件分岐による空欄チェック処理

変数の値が「空」であることを確認する

## 条件式5パターン

### １. 変数名をそのまま条件式に記述し、論理演算子の `!` で否定する

変数名をそのまま条件式に記述すると「変数に値が入っていれば」という条件を表すことができる  

`!` により「否定」し、真偽値を反転させる  

※`暗黙的な型変換`  
数値や文字列をそのまま条件式に指定したときに、PHPが自動的に、値に応じて論理型に型変換する  
→ これにより、意図しない結果を生み出す可能性がある  

<対策>  
- 明示的な型変換の使用  
    → `キャスト演算子（型キャスト）` を使用する  
- 厳密な比較演算子の使用  
- 型宣言の活用（引数や戻り値に（PHP 7以降））
- `declare(strict_types=1)`の利用  
    → スクリプトの先頭で使用すると、型宣言が厳密になる  
- 文字列比較関数の利用  
- `is_num関数` の利用  
    → 値が数値でないか判定する  

```php
if (!$a)
```
#### 「空」として扱われる値
`$a = " "` `$a = null` `$aが未定義` `$a = []`  
`$a = false` `$a = 0` `$a = "0"`  

→ `空の配列` や、`0` 、`"0"` を空欄として扱うかどうかは、そのプログラムが実現したい機能によって変わってくる  

---

### ２. `ゆるやかな比較演算子` を使う

`ゆるやかな比較` → データ型が異なる値同士でも比較できる  

```php
if ($a == " ")
```
#### 「空」として扱われる値
`$a = " "` `$a = null` `$aが未定義`    
`$a = false` `$a = 0` `$a = "0"`  

→ `空の配列` は「空」に判定されない  
→ `0` と `"0"` が空文字と同じ扱いになってしまう  

---

### ３. `empty関数` を使う

`empty関数` → 変数が「空」であるかどうかを判定する  

```php
if (empty($a))
```
#### 「空」として扱われる値
`$a = " "` `$a = null` `$aが未定義` `$a = []`  
`$a = false` `$a = 0` `$a = "0"`  

→ １の `if(!$a)` と、同じ結果となる  

---

### ４. `is_set関数` `is_null関数` を使う

`is_set関数` → 変数が定義されていて、かつ NULLとは異なることを判定する  
`is_null関数` → 変数が NULLかどうか判定する  

これらの関数は、`NULL` と `空文字` を区別する  

```php
if (!is_set($a))
```
※`is_set関数` を `!` で反転させることで、`is_null関数` と同じ判定結果にしている  
```php
if (is_null($a))
```
#### 「空」として扱われる値
`$a = null` `$aが未定義`  

→ `空文字` は「空」と判定できない

---

### ５. `is_null関数` と `厳密な比較演算子` を組み合わせる

`厳密な比較` → データ型も含めた比較  

```php
if (is_null($a) || $a === " ")
```
#### 「空」として扱われる値
`$a = " "` `$a = null` `$aが未定義`  

→ `NULL` と `空文字` を同一視したい場合（webページの入力フォームの必須チェックなど）は、この条件式が推奨される  

---

## `empty` `is_set` `is_null` 関数の違い（おさらい）

`empty`  
→ `変数が未定義` `定義したのみ` `NULL` `空文字` `0` `false` の場合に true を返す  

`is_set`  
→ 変数が未定義、定義したのみ、NULL `以外の場合` に true を返す  

`is_null`  
→ `変数が未定義` `定義したのみ` `NULL` の場合に true を返す  


## まとめ

- １～３は、あいまいな空欄チェックで、何を「空」とするか、判定範囲が広すぎる  
- ４，５は、`空文字` を含めるか否かでどっちを使うか決めると良い
- 暗黙的な型変換は意図しない結果を生み出す可能性があるため、適時対策が必要になる

---

[参考: PHP本格入門 上 p.119~124]()