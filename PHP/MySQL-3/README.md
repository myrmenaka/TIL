# 2025.7.24 - MySQLの基礎 2 データのINSERT（登録）処理

## 目的

HTMLフォームから送信されたデータを、PHPを使ってMySQLデータベースに `登録（INSERT）` する処理を学ぶ  
`バリデーション` 、 `エラーハンドリング` 、 `プリペアドステートメント` も取り入れる  

## 目次

- [`INSERT` 文の基本構文（SQL）](#1)
- [PHPで `INSERT` 処理を行う流れ](#2)
- [フォーム作成例（insert_form.php）](#3)
- [INSERT処理のコード例（insert_process.php）](#4)

## 学習内容

<a id="1"></a>

### `INSERT` 文の基本構文（SQL）

```sql
INSERT INTO テーブル名 (カラム名（列）1, カラム名（列）2, ...) 
VALUES (値1, 値2, ...);
```
- `INSERT INTO テーブル名`  
データを挿入するテーブルを指定  
- `(列1, 列2, ...)`  
データを挿入する列を指定  
省略可能で、省略した場合はテーブル定義の順に全ての列に値が挿入される  

    ※カラム名は省略可能だが、明示したほうが良い  
    >テーブルの構造が変わった場合やカラムの順序を間違えた場合はデータを正しく挿入できないケースがあります。  
    そのため、INSERTを行う場合はカラム名を明示することが推奨されています。  

- `VALUES (値1, 値2, ...)`  
各列に挿入する値を指定  
列の指定を省略した場合は、テーブル定義の順に値を対応させる  

[参考: 【SQL】INSERT文でデータを追加。基礎から応用例まで詳しく解説](https://techmania.jp/blog/sql-insert/)  

---
<a id="2"></a>

### PHPで `INSERT` 処理を行う流れ

1. HTMLフォームからPOSTでデータを受け取る
2. バリデーション（空チェックなど）を行う
3. データベースに接続
4. プリペアドステートメントでSQLを実行

---
<a id="3"></a>

### フォーム作成例

[insert_form.php](./insert_form.php)  



---
<a id="4"></a>

### INSERT処理のコード例

[insert_process.php](./insert_process.php)  



---
---
## セキュリティ面での注意

- `bindParam()` によるプリペアドステートメントでSQLインジェクション対策
- 入力内容のサニタイズ（表示時には、`htmlspecialchars()` ）  
- バリデーション未実施だと空データが登録される危険があるため要注意

## 練習問題 

フォームから「学習タイトル」と「内容」を送信し、`learning_logs` テーブルに登録するシステムを作成  

1. `insert_form.php` に入力フォームを作成  
2. `insert_process.php` でバリデーション後に `INSERT` 処理を記述  
3. `learning_logs` テーブルに新規データが追加されることを確認（phpMyAdmin でチェック）  

フォームから送信した内容がデータベースに保存され、「登録が完了しました」と表示される  

## 作業チェックリスト

- フォーム画面を作成できたか
- POST されたデータを安全に受け取れているか
- `INSERT` 文を正しく実行できたか
- エラーハンドリングを実装したか

## MEMO

- 00

---

参考: []()
